<html>

<head>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <!-- Load dependent stylesheets. -->
  
  <script async src="//cdn.opinionjoy.com/epj_prebid.min.js"></script>
  <!-- use recent version of videojs to ensure proper functioning with the iOS devices -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/video.js/6.4.0/video-js.css">
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/video.js/6.4.0/video.js"></script>
  <!-- videojs-vast-vpaid -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/videojs-vast-vpaid/2.0.2/videojs.vast.vpaid.min.css"
    rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/videojs-vast-vpaid/2.0.2/videojs_5.vast.vpaid.min.js"></script>

  <script>
    
  </script>

</head>

<body>
  <div style="max-width:640px; min-height:1px;">
		<video autoplay id="vid1" class="video-js vjs-default-skin" controls preload="auto">
			<source src="https://cdn.opinionjoy.com/vad/2.mp4" type="video/mp4" />
		</video>
	</div>
	
	<!-- Load dependent scripts -->
	<script src="//googleads.github.io/videojs-ima/node_modules/video.js/dist/video.min.js"></script>
	<script src="//imasdk.googleapis.com/js/sdkloader/ima3.js"></script>
	<script src="//googleads.github.io/videojs-ima/node_modules/videojs-contrib-ads/dist/videojs.ads.min.js"></script>
	<script src="//googleads.github.io/videojs-ima/dist/videojs.ima.js"></script>

	<script>
    function invokeVideoPlayer(url) {
      var options = {
        id: 'vid1',
        //   adTagUrl: 'http://pubads.g.doubleclick.net/gampad/ads?sz=640x480&iu=/124319096/external/ad_rule_samples&ciu_szs=300x250&ad_rule=1&impl=s&gdfp_req=1&env=vp&output=xml_vmap1&unviewed_position_start=1&cust_params=sample_ar%3Dpremidpostpod%26deployment%3Dgmf-js&cmsid=496&vid=short_onecue&correlator=',
        // adTagUrl: 'https://pubads.g.doubleclick.net/gampad/ads?sz=640x480&iu=/124319096/external/single_ad_samples&ciu_szs=300x250&impl=s&gdfp_req=1&env=vp&output=vast&unviewed_position_start=1&cust_params=deployment%3Ddevsite%26sample_ct%3Dskippablelinear&correlator=',
        adTagUrl: url
      };

      player.ima(options);
      // On mobile devices, you must call initializeAdDisplayContainer as the result
      // of a user action (e.g. button click). If you do not make this call, the SDK
      // will make it for you, but not as the result of a user action. For more info
      // see our examples, all of which are set up to work on mobile devices.
      // player.ima.initializeAdDisplayContainer();

      player.on('ads-manager', function (response) {
        var adsManager = response.adsManager;
        // Your code in response to the `ads-manager` event.
      })
    }
    
		var player = videojs('vid1', {
			autoplay: true,
			muted: true,
			responsive: true,
			aspectRatio: '4:3',
			fluid: true,
			fill: true
		});

    var pbjs = pbjs || {};
    pbjs.que = pbjs.que || [];


    /* Prebid video ad unit */

    var videoAdUnit = {
      code: 'video1',
      mediaTypes: {
        video: {
            context: 'instream',
            playerSize: [640, 480]
        }
      },

      bids: [{
        bidder: 'richaudience',
        params: {
          pid: 'JgsTTPVJ0j',
          supplyType: 'site'
        }
      },{
        bidder: 'medianet',
        params: {
          cid: '8CUO8FJ24',
          crid: '186775332'
        }
      }]
    };

    pbjs.que.push(function () {
      pbjs.addAdUnits(videoAdUnit);

      pbjs.setConfig({
        debug: true,
        cache: {
          url: 'https://prebid.adnxs.com/pbc/v1/cache'
        }
      });

      pbjs.requestBids({
        bidsBackHandler: function (bids) {
          var videoUrl = pbjs.adServers.dfp.buildVideoUrl({
            adUnit: videoAdUnit,
            params: {
              iu: '/98948493,21904908158/everypayjoy.com/epj-video',
              output: 'vast'
            }
          });
          console.log('videoUrl:--------------');
          console.log(videoUrl);
          invokeVideoPlayer(videoUrl);
        }
      });
    });

    
		
	</script>
  
</body>

</html>